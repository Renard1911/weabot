<?py include('templates/txt_base_top.html') ?>
<body class="mainpage">
<?py if banner_url: ?>
<center><img src="#{banner_url}" alt="Logo" /></center>
<?py #endif ?>
<div id="titlebox" class="outerbox lowmarg">
  <div class="innerbox">
    <h1>
      #{board_name}
    </h1>
    <div class="threadnavigation">
      <a href="#menu" title="Ir a la lista de hilos">&#9632;</a>
      <a href="#1" title="Ir al siguiente hilo">&#9660;</a>
    </div>
    <div id="rules">
      #{postarea_extra_html_top}
    </div>
  </div>
  <div class="innerbox">
    weabot
  </div>
</div>
<?py if force_css == "": ?>
<div id="stylebox" class="outerbox">
  <div class="innerbox">
    <strong>Estilo del board:</strong>
     <a href="javascript:set_stylesheet('Amber')">Amber</a>
     <a href="javascript:set_stylesheet('Blue Moon')">Blue Moon</a>
     <a href="javascript:set_stylesheet('Dickgirl')">Dickgirl</a>
     <a href="javascript:set_stylesheet('Headline')">Headline</a>
     <a href="javascript:set_stylesheet('Mercury')">Mercury</a>
     <a href="javascript:set_stylesheet('Pseud0ch')">Pseud0ch</a>
     <a href="javascript:set_stylesheet('Tanasinn')">tanasinn</a>
     <a href="javascript:set_stylesheet('Toothpaste')">Toothpaste</a>
     <a href="javascript:set_stylesheet('VIPPER')">VIPPER</a> 
    <br />
    <strong>Sitio:</strong>
    <?py include('templates/navbar.html') ?>
	[<a href="#{home_url}">Volver al home</a>]
  </div>
</div>
<?py #endif ?>
<a name="menu"></a>
<?py if threads: ?>
<div id="threadbox" class="outerbox lowmarg">
  <div class="innerbox">
    <div id="threadlist">
    <?py iter = 1 ?>
    <?py for thread in threads: ?>
        <?py if thread["length"] > 51: ?>
      <span class="threadlink"> <a href="#{boards_url}#{board}/read/#{thread['id']}/l50" rel="nofollow">#{iter}: </a><a href="##{iter}"> #{thread['posts'][0]['subject']} (#{thread['length']})</a> </span>
        <?py else: ?>
      <span class="threadlink"> <a href="#{boards_url}#{board}/read/#{thread['id']}" rel="nofollow">#{iter}: </a><a href="##{iter}"> #{thread['posts'][0]['subject']} (#{thread['length']})</a> </span>
        <?py #endif ?>
        <?py iter += 1 ?>
    <?py #endfor ?>
    <?py for thread in more_threads: ?>
        <?py if int(thread["length"]) > 51: ?>
      <span class="threadlink"> <a href="#{boards_url}#{board}/read/#{thread['id']}/l50" rel="nofollow">#{iter}: #{thread["subject"]} (#{thread["length"]})</a> </span>
        <?py else: ?>
      <span class="threadlink"> <a href="#{boards_url}#{board}/read/#{thread['id']}" rel="nofollow">#{iter}: #{thread["subject"]} (#{thread["length"]})</a> </span>
        <?py #endif ?>
        <?py iter += 1 ?>
    <?py #endfor ?>
    </div>
    <div id="threadlinks"> <a href="#newthread">Nuevo hilo</a> <a href="#{cgi_url}threadlist/#{board}">Todos los hilos</a>
    </div>
  </div>
</div>

<div id="posts">
    <?py titer = 1 ?>
    <?py for thread in threads: ?>
  <a name="#{titer}"></a>
  <div class="thread">
    <h2>
        <?py if int(thread["length"]) > 51: ?>
    <small>[#{titer}:#{thread['length']}]</small><a href="#{boards_url}#{board}/read/#{thread['id']}/l50" rel="nofollow">#{thread['posts'][0]['subject']}</a>
        <?py else: ?>
    <small>[#{titer}:#{thread['length']}]</small><a href="#{boards_url}#{board}/read/#{thread['id']}" rel="nofollow">#{thread['posts'][0]['subject']}</a>
        <?py #endif ?>
        <?py if thread['posts'][0]['locked'] == '1': ?>
    <small>(cerrado)</small>
        <?py elif thread['posts'][0]['locked'] == '2': ?>
    <small>(permasaged)</small>
        <?py #endif ?>
    </h2>
    <div class="threadnavigation"> <a href="#menu" title="Ir a la lista de hilos">&#9632;</a>
        <?py if titer > 1: ?>
    <a href="##{titer - 1}" title="Ir al hilo anterior">&#9650;</a>
        <?py else: ?>
    <a href="##{len(threads)}" title="Ir al hilo anterior">&#9650;</a>
        <?py #endif ?>
        <?py if titer < len(threads): ?>
    <a href="##{titer + 1}" title="Ir al siguiente hilo">&#9660;</a>
        <?py else: ?>
    <a href="#1" title="Ir al siguiente hilo">&#9660;</a>
        <?py #endif ?>
    </div>
    <div class="replies">
        <?py thenum = 1 ?>
        <?py omitted = (thread['omitted'] > 0) ?>
        <?py for post in thread['posts']: ?>
          <?py if post['num'] == 1: ?>
      <div class="firstreply">
              <?py thenum += 1 ?>
          <?py elif thenum == 2: ?>
      </div>
              <?py if thread['omitted'] > 0: ?>
      <div class="repliesomitted"></div>
              <?py #endif ?>
      <div class="finalreplies">
              <?py thenum += 1 ?>
          <?py #endif ?>
          <?py if post['IS_DELETED'] == '1': ?>
        <div class="deletedreply"> <h3 class="front"> <span class="replynum">#{post['num']}</span> Post eliminado por el usuario.  </h3> </div>
          <?py elif post['IS_DELETED'] == '2': ?>
        <div class="deletedreply"> <h3 class="front"> <span class="replynum">#{post['num']}</span> Post eliminado por staff.  </h3> </div>
          <?py else: ?>
        <div class="reply">
          <h3 class="front"> <span class="replynum"><a title="Citar este post en tu respuesta" href="javascript:insert('&gt;&gt;#{post['num']}',#{thread['id']})">#{post['num']}</a></span>
          Nombre:
              <?py if post['email']: ?>
          <span class="postername"><a href="mailto:#{post['email']}">#{post['name']}</a></span>
                <?py if post['tripcode']: ?>
          <span class="postertrip"><a href="mailto:#{post['email']}">#{post['tripcode']}</a></span>
                <?py #endif ?>
              <?py else: ?>
          <span class="postername">#{post['name']}</span>
                <?py if post['tripcode']: ?>
          <span class="postertrip">#{post['tripcode']}</span>
                <?py #endif ?>
              <?py #endif ?>
          : #{post['timestamp_formatted']}
              <?py if post['file']: ?>
          <span class="filesize">(Imagen: <em>#{post['file_size_formatted']}, #{post['image_width']}x#{post['image_height']}</em>)</span>
              <?py #endif ?>
              <?py if int(post['parentid']) == 0: ?>
            <span class="dnb|#{board}|#{post['id']}|y|#{post['locked']}"></span>
              <?py else: ?>
            <span class="dnb|#{board}|#{post['id']}|n"></span>
              <?py #endif ?>
          <span class="deletebutton">
              <?py if reports_enable: ?>
          [<a class="rep" href="#{cgi_url}report/#{board}/#{post['id']}/#{post['num']}" rel="nofollow">Rep</a>]
              <?py #endif ?>
          [<a href="javascript:delete_post(#{post['num']},#{post['id']})" rel="nofollow">Del</a>]
          </span> </h3>
              <?py if post['file']: ?>
          <a target="_blank" href="#{images_url}#{board}/src/#{post['file']}"><img src="#{images_url}#{board}/thumb/#{post['thumb']}" alt="#{post['id']}" class="thumb" width="#{post['thumb_width']}" height="#{post['thumb_height']}" /></a>
              <?py #endif ?>
          <div class="replytext">
            #{post['message']}
          </div>
        </div>
              <?py if post['shortened']: ?>
        <div class="replyabbrev">Post muy largo. Clic para ver el <a href="#{boards_url}#{board}/read/#{thread['id']}/#{post['num']}" rel="nofollow">post</a> o el <a href="#{boards_url}#{board}/read/#{thread['id']}">hilo completo</a>.</div>
              <?py #endif ?>
          <?py #endif ?>
        <?py #endfor ?>
      </div>
    </div>
    <form id="postform#{thread['id']}" action="#{cgi_url}post" method="post" enctype="multipart/form-data">
      <input type="hidden" name="board" value="#{board}" />
      <input type="hidden" name="parent" value="#{thread['id']}" />
      <input type="hidden" name="password" value="" />
      <div style="padding-left: 32pt;">
        <?py if thread['posts'][0]['locked'] == '1': ?>
        <div style="padding-left: 30pt;">
        <big>Este hilo ha sido cerrado. Ya no se puede postear en &eacute;l.</big>
        <?py else: ?>
        <input type="submit" value="Responder" />
        Nombre: <input type="text" name="fielda" size="19" maxlength="75" /><span class="capcodecheckbox"></span>
        E-mail: <input type="text" name="fieldb" size="19" maxlength="75" />
        <div style="display:none;">Trampa (deja estos campos en blanco):
         <input type="text" name="name" size="19" maxlength="75" />
         <input type="text" name="email" size="19" maxlength="75" />
        </div>
        <small><a href="javascript:show('options#{thread['id']}')">M&aacute;s opciones...</a></small>
        <div style="padding-left: 30pt;">
          <div style="display:none;vertical-align:top" id="options#{thread['id']}">
            Formato:
            <select name="markup">
              <option value="none" >Ninguno</option>  
              <option value="tags" selected="selected">Tags</option>
              <option value="aa" >Text Art</option> 
            </select>
            <label><input type="checkbox" name="savemarkup" /> Siempre usar este formato</label>&nbsp;
            <label><input type="checkbox" name="noko" accesskey="n" />Redirigir al hilo</label>&nbsp;&nbsp;
            <input type="button" value="Previsualizar post" onclick="preview_post('postform#{thread['id']}','#{thread['id']}')" />
            <br />
            <div id="preview#{thread['id']}" class="replytext" style="display:none"></div>
          </div>
          <textarea name="message" cols="64" rows="5"></textarea>
          <?py if allow_image_replies: ?>
          <br />Archivo: <input type="file" name="file" size="45" />
          <?py #endif ?>
        <?py #endif ?>
          <div class="threadlinks">
            <a href="#{boards_url}#{board}/read/#{thread['id']}">Hilo completo</a>
        <?py if thread['length'] > 51: ?>
            <a href="#{boards_url}#{board}/read/#{thread['id']}/l50" rel="nofollow">&Uacute;ltimos 50</a>
        <?py #endif ?>
        <?py if thread['length'] > 101: ?>
            <a href="#{boards_url}#{board}/read/#{thread['id']}/-100" rel="nofollow">1-100</a>
        <?py #endif ?>
            <a href="#menu" rel="nofollow">Lista de hilos</a>
            <a href="." rel="nofollow">Recargar</a>
          </div>
        </div>
      </div>
    </form>
    <script type="text/javascript">set_inputs("postform#{thread['id']}");</script>
  </div>
        <?py titer += 1 ?>
    <?py #endfor ?>
</div>
<?py #endif ?>

<a name="newthread"></a>
<div id="createbox" class="outerbox lowmarg">
  <div class="innerbox">
    <h2>Nuevo hilo</h2>
    <form id="threadform" action="#{cgi_url}post" method="post" enctype="multipart/form-data">
      <input type="hidden" name="board" value="#{board}" />
      <input type="hidden" name="password" value="" />
      <table>
        <tbody> 
          <tr>
            <td>T&iacute;tulo:</td>
            <td>
              <input type="text" name="subject" size="46" maxlength="75" />
              <input type="submit" value="Crear nuevo hilo" />
            </td>
          </tr>
          <tr>
            <td> Nombre:  </td>
            <td>
              <input type="text" name="fielda" size="19" maxlength="75" /><span class="capcodecheckbox"></span> E-mail:
              <input type="text" name="fieldb" size="19" maxlength="75" />
              <div style="display:none;">Trampa (deja estos campos en blanco):
               <input type="text" name="name" size="19" maxlength="75" />
               <input type="text" name="email" size="19" maxlength="75" />
              </div>
              <small>
                <a href="javascript:show('options')">M&aacute;s opciones...</a>
              </small> 
            </td> 
          </tr>
          <tr style="display:none;vertical-align:top" id="options">
            <td>Formato:</td>
            <td>
              <select name="markup" onchange="select_markup(this)"> 
                <option value="none" >Ninguno</option>  
                <option value="tags" selected="selected">Tags</option>
                <option value="aa" >Text Art</option> 
              </select>
              <label><input type="checkbox" name="savemarkup" /> Siempre usar este formato</label>&nbsp;
              <label><input type="checkbox" name="noko" accesskey="n" />Redirigir al hilo</label>
              &nbsp;&nbsp;
              <input type="button" value="Previsualizar post" onclick="preview_post('threadform','0')" /> <br />
              <small></small>
              <div id="preview0" class="replytext" style="display:none">
              </div>
            </td>
          </tr>
          <tr> 
            <td></td> 
            <td>
              <textarea name="message" cols="64" rows="5"></textarea>
            </td>
          </tr>
          <?py if allow_images: ?>
          <tr><td>Archivo:</td><td><input type="file" name="file" size="45" /></td></tr>
          <?py #endif ?>
        </tbody>
      </table>
    </form> 
  </div>
</div> 
<script type="text/javascript">set_inputs("threadform");</script>
<?py include('templates/txt_base_bottom.html') ?>
